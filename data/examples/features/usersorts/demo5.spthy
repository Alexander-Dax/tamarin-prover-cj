theory Demo5
begin

builtins: symmetric-encryption, hashing, natural-numbers

rule Create:
    [ Fr(~s) ]
  --[ Start(~s) ]->
    [ Counter(~s, 0:nat)]

rule Inc:
    [ Counter( ~s, x:nat ) ]
  --[ Counter( ~s, x:nat ) ]->
    [ Counter( ~s, (x:nat + 1) ) 
    , Out( senc( x:nat,  ~s ) ) ]

end
